<div class="odDebug" layout="column">
  <div layout="row">
      <h1 class="md-display-1 pageName" ng-if="$ctrl.existingExercise">{{$ctrl.pageName}}</h1>
      <div class="pageDesc" ng-if="$ctrl.existingExercise">{{$ctrl.exerciseDescription}}</div>
      <div flex></div>
      <md-button aria-label="Help" class="helpButton" ng-click="$ctrl.displayHelp($event)">
          <i class="fa fa-question-circle helpIcon"></i>
      </md-button>
  </div>

  <div layout="row" flex>
    <div class="lhs" layout="column" flex="60">
      <div class="codeArea" flex style="height: 100%;">
        <md-content class="tabs">
          <md-tabs class="codeBlockTabs" md-selected="$ctrl.selectedTabNum">
            <md-tab class="codeBlockTab" label="Flag Errors" ng-click="$ctrl.toFlagging()">
              <md-tab-body>
                <div class="codeBlock" id="codeBlock" flex>
                  <code-block code-string="$ctrl.codeString" current-line="$ctrl.codeTrace[$ctrl.currentTraceIndex].line"
                    breakpoints="$ctrl.breakpoints" flags="$ctrl.flags"
                    icon-action="$ctrl.toggleIcon(line, icon)" is-editing="$ctrl.isEditing"></code-block>
                </div>
              </md-tab-body>
            </md-tab>
            <md-tab class="codeBlockTab" label="Fix Errors" ng-click="$ctrl.toEditing()">
              <md-tab-body>
                <div class="codeBlock" id="codeBlock" flex>
                  <code-block code-string="$ctrl.codeString" current-line="$ctrl.codeTrace[$ctrl.currentTraceIndex].line"
                    breakpoints="$ctrl.breakpoints" flags="$ctrl.flags"
                    icon-action="$ctrl.toggleIcon(line, icon)" is-editing="$ctrl.isEditing"></code-block>
                </div>
              </md-tab-body>
            </md-tab>
          </md-tabs>
        </md-content>
      </div>

      <div class="debugButtons" layout="row">
        <md-button class="md-raised debugButton" flex ng-disabled="$ctrl.isEditing" ng-click="$ctrl.goToStart()">
          <md-icon md-font-icon="fa" class="fa-fast-backward"></md-icon>
          <md-tooltip md-direction="bottom">Go To Start</md-tooltip>
        </md-button>
        <md-button class="md-raised debugButton" flex
          ng-disabled="$ctrl.currentTraceIndex <= 0 || $ctrl.isEditing" ng-click="$ctrl.stepBack()">
          <md-icon md-font-icon="fa" class="fa-step-backward"></md-icon>
          <md-tooltip md-direction="bottom">Step Backward</md-tooltip>
        </md-button>
        <md-button class="md-raised debugButton" flex ng-disabled="$ctrl.isEditing" ng-click="$ctrl.run()">
          <md-icon md-font-icon="fa" class="fa-play"></md-icon>
          <md-tooltip md-direction="bottom">Run</md-tooltip>
        </md-button>
        <md-button class="md-raised debugButton" flex
          ng-disabled="$ctrl.currentTraceIndex >= $ctrl.codeTrace.length - 1 || $ctrl.isEditing" 
          ng-click="$ctrl.stepForward()">
          <md-icon md-font-icon="fa" class="fa-step-forward"></md-icon>
          <md-tooltip md-direction="bottom">Step Forward</md-tooltip>
        </md-button>
        <md-button class="md-raised debugButton" flex  ng-disabled="$ctrl.isEditing" ng-click="$ctrl.goToEnd()">
          <md-icon md-font-icon="fa" class="fa-fast-forward"></md-icon>
          <md-tooltip md-direction="bottom">Go To End</md-tooltip>
        </md-button>
      </div>
    </div>

    <div class="rhs" layout="column" flex>
      <md-card class="memory">
        <div class="md-card-content code-block" ng-repeat="frame in $ctrl.memory">
          <div class="md-subhead frameHeading" ng-click="$ctrl.openStackFrame(frame.id)"
            ng-class="{'no-border-bottom': frame.id !== $ctrl.visibleFrameId && !$last}" layout="row">
            <md-icon md-font-icon="fa" class="frameIcon"
              ng-class="frame.id === $ctrl.visibleFrameId ? 'fa-chevron-down' : 'fa-chevron-right'"></md-icon>
            <span>{{frame.name}}</span>
            <span flex></span>
          </div>
        </md-card>
        <md-card class="displayCard exceptions" ng-show="$ctrl.codeTrace[$ctrl.currentTraceIndex].exception_msg">
          <div class="md-title cardHeading">Error</div>
          <div class="code-block">
            <code><pre>{{$ctrl.codeTrace[$ctrl.currentTraceIndex].exception_msg}}</pre></code>
          </div>
        </div>
      </md-card>
      <md-card class="displayCard exceptions" ng-show="$ctrl.codeTrace[$ctrl.currentTraceIndex].exception_msg">
        <div class="md-title cardHeading">Error</div>
        <div class="code-block">
          <code><pre>{{$ctrl.codeTrace[$ctrl.currentTraceIndex].exception_msg}}</pre></code>
        </div>
      </md-card>
      <md-card class="displayCard">
        <div class="md-title cardHeading outHeading">Output</div>
        <div class="md-card-content code-block" hljs hljs-source="$ctrl.codeTrace[$ctrl.currentTraceIndex].stdout">
        </div>
      </md-card>

      <div flex><span></span></div>
      
      <div align="right">
        <md-button type="submit" aria-label="check flags" class="md-accent md-raised"
          ng-click="$ctrl.submit()" ng-show="!$ctrl.checkingCode">
          Check
        </md-button>
        <div ng-if="$ctrl.checkingCode">
          <md-progress-circular md-mode="indeterminate"></md-progress-circular>
        </div>
      </div>
    </div>
  </div>
</div>